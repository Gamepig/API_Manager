# 6. 版本控制與持續整合/部署 (CI/CD)

本階段將建立並優化專案的版本控制策略，並設定自動化的持續整合與部署流程，以提高開發效率和發布品質。

## 6.1 Git 工作流程

*   [ ] 選擇並確認專案將採用的 Git 工作流程（例如 Git Flow 或 GitHub Flow）。
*   [ ] 確保所有開發人員都熟悉該工作流程。
*   [ ] 定義分支命名規範 (例如 `feature/xxx`, `bugfix/xxx`, `release/xxx`)。
*   [ ] 制定 Pull Request (PR) 審核規範。
*   [ ] 定期進行程式碼審核 (Code Review) 並合併分支。
*   [ ] **將開發進度定期推送到遠程倉庫：**
    ```bash
    git add .
    git commit -m "feat: 實作XXX功能"
    git push origin <當前分支名稱>
    ```

## 6.2 CI/CD 設定

*   [ ] **選擇 CI/CD 工具：** 根據團隊或專案需求，選擇合適的 CI/CD 平台 (例如 GitHub Actions, GitLab CI/CD, Jenkins, CircleCI)。
*   [X] **建立 CI/CD 設定檔案：** 在專案根目錄或指定位置建立 CI/CD 設定檔 (例如 `.github/workflows/main.yml` for GitHub Actions)。
*   [X] **設定 CI 流程：**
    *   [X] **觸發器：** 設定在以下情況觸發 CI 流程：
        *   每次 `push` 到 `main` 或 `develop` 等主要分支時。
        *   每次提交 Pull Request (PR) 時。
    *   [X] **環境準備：** 定義 CI 環境，確保安裝了 Python、UV、PM2 (可選擇在 CI 環境中模擬安裝或使用 Docker)。
    *   [X] **依賴安裝：** 使用 UV 安裝專案依賴。
        ```bash
        uv pip install -r requirements.txt
        ```
    *   [X] **程式碼品質檢查：** 運行程式碼靜態分析工具 (`flake8`, `pylint`)、程式碼風格檢查工具 (`Black`)。
    *   [X] **運行測試：** 執行所有單元測試和整合測試。
        ```bash
        pytest
        ```
    *   [ ] **構建打包 (若有)：** 如果應用程式需要打包為可執行文件 (例如使用 PyInstaller)，在此步驟執行打包命令。
*   [ ] **設定 CD 流程 (可選，根據部署方式)：**
    *   [ ] **部署觸發器：** 設定在 CI 成功完成且合併到 `main` 分支後觸發部署。
    *   [ ] **部署環境準備：** 配置目標部署伺服器或平台。
    *   [ ] **部署策略：** 選擇合適的部署策略 (例如藍綠部署、金絲雀部署)。
    *   [ ] **執行部署命令：** 將構建好的應用程式部署到測試環境或生產環境。
*   [ ] **通知設定：** 設定 CI/CD 結果通知 (例如郵件、Slack 訊息)。

## 6.3 單元測試 (CI/CD 設定)

*   [ ] **無特定單元測試：** CI/CD 設定階段主要為配置，不涉及可單元測試的程式碼邏輯。

## 6.4 實際測試 (CI/CD 設定)

*   [ ] **CI 流程驗證：**
    *   [ ] 手動提交一個小更改到功能分支，創建 PR，驗證 CI 流程是否被正確觸發並運行所有檢查。
    *   [ ] 故意引入一個 linter 錯誤或測試失敗，驗證 CI 是否能正確捕獲並報告錯誤。
*   [ ] **CD 流程驗證 (如果已設定部署)：**
    *   [ ] 執行一次完整的部署流程，驗證應用程式是否能成功部署到目標環境並正常運行。
    *   [ ] 測試在部署失敗時，是否能正確回滾或提供清晰的失敗訊息。
*   [ ] **版本管理驗證：**
    *   [ ] 驗證 Git 分支策略是否得到遵守。
    *   [ ] 確認每次提交都附帶有意義的提交訊息。 